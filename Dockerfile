
FROM node:24-bullseye
WORKDIR /usr/src/app

# Ensure build tools are available for native modules like sharp
RUN apt-get update && apt-get install -y python3 make g++ && rm -rf /var/lib/apt/lists/*

# Install dependencies first to leverage Docker layer caching
COPY package*.json ./
RUN npm install 


# Copy the rest of the application source
COPY . .

ENV APP_NAME  AuthApp

ENV HOST localhost
ENV PORT 8000

ENV DATABASE_URI mongodb+srv://josephvarghese98128_db_user:DtoIXmEnS6WtSpJG@cluster0.sxj1jwf.mongodb.net/?retryWrites=true&w=majority&appName=Cluster0

ENV JWT_ACCESS_TOKEN_SECRET_PRIVATE 'LS0tLS1CRUdJTiBSU0EgUFJJVkFURSBLRVktLS0tLQpNSUlFcEFJQkFBS0NBUUVBeEFhTnlZTXR0QVlwM3pTWjlrWnJqYjgwaG84ZEZFQiszM1pFOGZZdWlwMEhhenprClJsOXVmbzZKSmVmSTNid09KR1FzRWJ4cHQ0dm5mVHdaQTFqY0paVy9hdHFWZGRldzl6TnhTell3ZjRhNUNKTk4KMHhnVTBVNlRwREVrbk5kTS9aR2VDTFN6dDhUR0VpTkhHQ2RJNXNwZ3ZNTTZFRVpLZ0c5N2c5OU9LUmJQTEZNUgpFVlRJK003NFQyUmp0NFlubWprYTFaeWpvNUYwQ3NhSjI2NElmMjQ4ODdnQkRRVk1QT3JINmV5d1FMUXNCSFNNCmtWQ1dSbzd0TDc2VnZaSkhGMkVlb0VzZXZxQ0hocGdRTzBoTXlHbWNFOXhWYjBZNFZNTzVTZURpcndHa3JTVEoKditVNHZxUEJER2kvMEY2QitQOUJ4aWhUTmRNY2l0cHRPUDlaaXdJREFRQUJBb0lCQUNWUkNoVGVnQWpSVTQ5RwpPRGtGMXR1NUZvcTNHOVlMSVJ2eEs5YlVBckFvakkwQm5vTTNENVhRRkpPK3VDSmQ5bU0vSHBTUnhaNUhaOTRUClhyK2dYdWhZeFlQVjhMWHFSYW9KaFB2SWFSc2R6b092WnhWVWRFSVVMMDhHZSszUG5yeDJ5QnJvSzM1RVcyQ0EKanJ3dVhsWnhHRkZXNk9ySU5zNlVhbk1FUTZEV2ZOUFBQeURDb0hBM1hVQzJRQ2hKbDNtTlRZcFZDTjVBS2pTMAo2TWVHb2tJMWQyMWdCSkdRaGY5eDB6alEvQlNZcGFhalJjY3NqbDF0UkNXRFJpbm9yMnhrdTdsSHJ3UjBWQmJNClp0M2sxb29vL3k5QVNVSlBxSnZBaEN4c25LejVpcHY3ZWJBS0JpQTV6dUZNUlh3b0QwL040djBiZGJ5a3hTSzMKRS9hZlZJRUNnWUVBL1MzNmU1d09weTNXRi85amFGVjJvUkprR1o4OGJuZWxidEIvNVBKOVcvUHVweURhR0M5dwpjN1RZWDF0RkEwNkh3TXNGWi85WWhmeEFHMldOcFJKcjA4U0pQTHFxWWpGRU4zRlh0SHkxT3JYWjNoVUJPL2lECjQyUXA3Mkh1WWVkWmM0TFBqSjN5RW5MYTNXdUpFT2xEN0o5bjBXdXpGMDYxNGJVWDRucXFrekVDZ1lFQXhqV1YKTGN0QldNNy9mbzU1bmtGR21yMC9wR1BnUStETXZVOU9WRGcrTGlETm00TEZQeGk4cVpWMFJiTy84NzhiTi9ERwp5dzR2dzBMRHFtcnBOZi8xd0VwTjAxUHp5djY1SWFVZmswT0wxc0EvUjA1bVgrcE9OdFJYek1KcjlJOFBYMEwrCjIrRnhWeXNKZ0tsRFdiS0s0RjhsODBtcDg1Y2VnYTJ6b1lheWNYc0NnWUVBbGJWM2RWcHRhN3YxNmxEUkZtUGEKOXhucDZTQzQybFdUbEhoaitCelB0ZTBEUlA1dkdIZ00xYzZ0VjQyZnZIbldXbEZ5eS9FNUJsbUlDdXM5Rzh4Tgp5SFpoOUhBb3lsRjVsaE5HbW1wWHUvVEdkTVVVNnNKa01yVUsrd3Q4cTVYaTFpUVcySDZaSXdHWm0rNjNxVEZXClFmaHNxbkEyQVdWQXRjdWc2UUpDRlRFQ2dZQnBwZDNpRHRqQjhYT1ZqWE9kdXNWYmJVd2kzMm1HUktoY3I0emMKcnkzVmdINlhTVmpCalBuaW1scmpYREFRUitqR0pIeVJkdnBXWlp2TmxqYkFKYkpqMERjelVTZzlKeENlc2xqbQpNYmF6dkx6OTBQZ1lYOWRZdWs0aVFlOHc1NkFWOHF2Tm41aStFWjU3Q2Ixd2JnNUFFZmMwZWlzd1AzaHZQcHJrCm1kczdTUUtCZ1FEZXdIZUhUd2htZkdSYy8wQ1RSR3ROL0M0Uy9XU3NRSnRtcnJpQ3dhNytUeHlLbTMxMkxWS2MKa01LanBBWVVLQUc3RnFJQ1E4M3phZjdqdHJEdG9OTFZ3Q2xyem94ZWhIc0drNThxblozbVJnNjFZc2ZxaXJhUApMaWxBZ3VLTjE5bkltYjdYWDdtKzlwTnEwOGpka293WWgxcmt4a1gzNFlCTlFCNFkxbmpCMFE9PQotLS0tLUVORCBSU0EgUFJJVkFURSBLRVktLS0tLQo='
ENV JWT_ACCESS_TOKEN_SECRET_PUBLIC 'LS0tLS1CRUdJTiBSU0EgUFVCTElDIEtFWS0tLS0tCk1JSUJDZ0tDQVFFQXhBYU55WU10dEFZcDN6U1o5a1pyamI4MGhvOGRGRUIrMzNaRThmWXVpcDBIYXp6a1JsOXUKZm82SkplZkkzYndPSkdRc0VieHB0NHZuZlR3WkExamNKWlcvYXRxVmRkZXc5ek54U3pZd2Y0YTVDSk5OMHhnVQowVTZUcERFa25OZE0vWkdlQ0xTenQ4VEdFaU5IR0NkSTVzcGd2TU02RUVaS2dHOTdnOTlPS1JiUExGTVJFVlRJCitNNzRUMlJqdDRZbm1qa2ExWnlqbzVGMENzYUoyNjRJZjI0ODg3Z0JEUVZNUE9ySDZleXdRTFFzQkhTTWtWQ1cKUm83dEw3NlZ2WkpIRjJFZW9Fc2V2cUNIaHBnUU8waE15R21jRTl4VmIwWTRWTU81U2VEaXJ3R2tyU1RKditVNAp2cVBCREdpLzBGNkIrUDlCeGloVE5kTWNpdHB0T1A5Wml3SURBUUFCCi0tLS0tRU5EIFJTQSBQVUJMSUMgS0VZLS0tLS0K'
ENV JWT_ACCESS_TOKEN_EXPIRATION_MINUTES 15

ENV REFRESH_TOKEN_EXPIRATION_DAYS 750
ENV VERIFY_EMAIL_TOKEN_EXPIRATION_MINUTES 1440
ENV RESET_PASSWORD_TOKEN_EXPIRATION_MINUTES 30

ENV SMTP_HOST smtp.gmail.com
ENV SMTP_PORT 587
ENV SMTP_USERNAME josephvarghese98128@gmail.com
ENV SMTP_PASSWORD fsgw zdqy fago kqla
ENV EMAIL_FROM wondercreativestudio@gmail.com

EXPOSE 8000

CMD ["npm", "run", "dev"]
